<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css">
    <title> 發佈留言 | e^(πi) = 附1 </title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="res/css/loading-pre.css">
    <script src="res/js/loading-pre.js"></script>
</head>
<body>
    <div id="loading" class="loading-barrier">
        <div class="loading-animation">
            <h1><span>L</span><span>o</span><span>a</span><span>d</span><span>i</span><span>n</span><span>g</span><span>.</span><span>.</span><span>.</span></h1>
        </div>
    </div>
    <div class="container">
        <div class="bar">
            <nav class="navbar navbar-expand-lg navbar-light bg-light">
                <a class="navbar-brand" href="./">  e<sup>πi</sup> = 附1  </a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#bar" aria-controls="bar" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <div class="collapse navbar-collapse" id="bar">
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item">
                            <a class="nav-link" href="./">首頁</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="./collection">研究成果</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="./message">留言區</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="./others">其他</a>
                        </li>
                    </ul>
                </div>
            </nav>
        </div>
        <div class="content">
            <h2>發佈留言</h2>
            <textarea class="form-control" id="message" rows="6" placeholder="在此寫下你的留言..."></textarea>
            <select class="custom-select" id="classification">
                <option selected value="未分類">給 附中數資 35 屆</option>
                <option disabled value="未分類"> ---------- </option>
                <option value="數學專題">給 數學組</option>
                <option value="數學_1"> 給 數學 - 一層一層串起你的心</option>
                <option value="數學_2"> 給 數學 - 圓例覺醒</option>
                <option value="數學_3"> 給 數學 - Shoot！圓錐曲線神射手</option>
                <option value="數學_4"> 給 數學 - Be Equal</option>
                <option disabled value="未分類"> ---------- </option>
                <option value="物理專題">給 物理組</option>
                <option value="物理_1"> 給 物理 - 旋出新視界</option>
                <option value="物理_2"> 給 物理 - 強制水漩渦之分析</option>
                <option disabled value="未分類"> ---------- </option>
                <option value="化學專題">給 化學組</option>
                <option value="化學_1"> 給 化學 - 2D 奈米二硫化鉬-新型汙水救星相關研究</option>
                <option value="化學_2"> 給 化學 - 如何微笑</option>
                <option value="化學_3"> 給 化學 - 利用銅網型液晶分析法檢測空氣中微粒</option>
                <option disabled value="未分類"> ---------- </option>
                <option value="生物專題">給 生物組</option>
                <option value="生物_1"> 給 生物 - 利用班馬魚胚胎測試Cisplatin導致的傷害及NAC的保護效果</option>
                <option value="生物_2"> 給 生物 - 探討粒線體對果蠅卵巢生殖幹細胞維持的影響</option>
                <option value="生物_3"> 給 生物 - 以蛋白質體分析探討細胞複製與分化</option>
                <option value="生物_4"> 給 生物 - 比較脂質體及非脂質體轉染試劑</option>
                <option value="生物_5"> 給 生物 - 記憶猶新—Scopolamine 對斑馬魚記憶能力與社交行為的影響</option>
                <option value="生物_6"> 給 生物 - 中華珈蟌水蠆環境偏好探討</option>
                <option value="生物_7"> 給 生物 - 酒精對水蚤趨光性影響之探討</option>
                <option disabled value="未分類"> ---------- </option>
                <option value="地科專題">給 地科組</option>
                <option value="地科_1"> 給 地科 - 近岸波與單樁式離岸風電基座關係初探</option>
                <option value="地科_2"> 給 地科 - 熱力風模擬與分析</option>
                <option value="地科_3"> 給 地科 - 雙眼牆颱風的內眼滾動</option>
                <option disabled value="未分類"> ---------- </option>
                <option value="資訊專題">給 資訊組</option>
                <option value="資訊_1"> 給 資訊 - 遷移學習如何建立辨識日式插畫角色之神經網路</option>
                <option value="資訊_2"> 給 資訊 - 利用 RFID 增進校園安全</option>
                <option value="資訊_3"> 給 資訊 - 用機器學習判斷文本的主觀資訊</option>
            </select>
            <button id="send" type="button" class="btn btn-primary" onclick="sendOut()">送出</button>
        </div>
    </div>
    <link href="https://stackpath.bootstrapcdn.com/bootswatch/4.4.1/flatly/bootstrap.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
    <style>
    body {
        background: rgba(0,0,128,.5) url("res/img/background_x2.jpg") no-repeat center;
        background-size: cover;
    }
    .container {
        background-color: rgba(255,255,255,.5);
        min-width: 80%;
        height: 100%;
        box-shadow: 0 0 8px 8px rgba(32, 32, 32, 0.2);
    }
    .bar {
        z-index: 3;
        margin: 0 -15px;
        box-shadow: 0px 4px 8px 0px rgba(32, 32, 32, 0.3);
    }
    .content {
        padding: 24px 4px;
    }
    #message, #classification, #send {
        margin: 12px 0 4px 0;
    }
    </style>
    <script src="https://www.gstatic.com/firebasejs/7.14.5/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.14.5/firebase-firestore.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@9"></script>
    <script src="res/js/firebase-helper.js"></script>
    <script>
    var helper = new firebaseHelper();
    helper.init();

    function sendOut() {
        var msg = document.getElementById("message").value;
        if(msg.length < 1) return;
        document.getElementById("send").disabled = true;
        helper.messages.make(msg, tag(document.getElementById("classification").value)).then(result => {
            if(result) {
                Swal.fire("已送出！", "我們已經收到你的留言了！請稍後片刻，我們將會回覆你。", "success");
                document.getElementById("message").value = "";
                document.getElementById("send").disabled = false;
            }
        });
    }

    function tag(val) {
        var tags = [];
        switch (val) {
            case val.includes("數學_"):
            tags.push("數學專題");
            break;
            case val.includes("物理_"):
            tags.push("物理專題");
            break;
            case val.includes("化學_"):
            tags.push("化學專題");
            break;
            case val.includes("生物_"):
            tags.push("生物專題");
            break;
            case val.includes("地科_"):
            tags.push("地科專題");
            break;
            case val.includes("資訊_"):
            tags.push("資訊專題");
            break;
        }
        tags.push(val);
        return tags;
    }

    stopLoading(document.getElementById("loading"));
    </script>
</body>
</html>
